---
title: "Human Development Index 2021"
author: "Ananya Sinha  |  MSD202307"
urlcolor: blue
output:
  pdf_document: default
  html_document:
    df_print: paged
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

The **Human Development Index (HDI)** is a statistic developed by the United Nations since 1990 to measure various countries’ levels of social and economic development. It is a summary measurement of basic achievement levels in human development. 

The HDI of a country is calculated by taking the geometric mean of the indices of the following three aspects:

* **Knowledge and Understanding:** Education is measured by the *mean years of schooling* for residents of a country, and the *expected years of schooling* that a child has at the average age for starting school. These are each separately normalized so that both 15 mean years of schooling and 18 years of expected schooling equal 1, and an arithmetic mean of the two is calculated.
* **A Long and Healthy Life:** This aspect of the HDI is measured by the *life expectancy*, as calculated at the time of birth, in each country, and normalized so that this component is equal to 0 when life expectancy is 20 and equal to 1 when life expectancy is 85.
* **An Acceptable Standard of Living:** Standard of living represented by is *GNI per capita* based on purchasing power parity (PPP), a common metric used to reflect average income. The standard of living is normalized so that it is equal to 1 when GNI per capita is $75,000 and equal to 0 when GNI per capita is $100.

$HDI = \sqrt[3]{(I_h * I_e * I_i)}$

where  
$I_h$ is the indicator for health,  
$I_e$ is the indicator for education and  
$I_i$ is the indicator for income.

This project aims to analyse patterns of HDI values across different regions and growth patterns over the years. We study the factors contributing to HDI and visualise the relationships between them. We also study how the HDI is distributed across continents.


# Data Description

[*`Dataset`*](https://hdr.undp.org/data-center/documentation-and-downloads)

The variables of interest are as follows:

For 2021 -

1. `Country`: Name of the country
2. `HDI Value`: Value of HDI
3. `Life Expectancy at Birth`: Number of years a newborn infant could expect to live if prevailing patterns of age-specific mortality rates at the time of birth stay the same throughout the infant’s life.
4. `Expected years of schooling`: Number of years of schooling that a child of school entrance age can expect to receive if prevailing patterns of age-specific enrolment rates persist throughout the child’s life.
5. `Mean years of schooling`: Average number of years of education received by people ages 25 and older, converted from education attainment levels using official durations of each level.
6. `HDI Level`: A categorical variable indicating whether the level of HDI is "Very High", "High", "Medium", "Low" or "Other".
7. `Gross National Income per capita`: Aggregate income of an economy generated by its production and its ownership of factors of production.

For Other Years -

7. `HDI Value`: 1990, 2000, 2010, 2015, 2018, 2019, 2020
8. `Average Annual HDI Growth %`: 1990-2000, 2000-2010, 2010-2021, 1990-2021
9. `Change in HDI rank`: Change in HDI rank from 2015 to 2021


# Exploratory Data Analysis

[HDI Across the World (2021)]{.underline} 

The graph displayed below represents a heatmap illustrating the distribution of Human Development Index (HDI) values for countries across the world in the year 2021. In this map, the colour scale ranges from green, representing countries with high HDI scores, to red, indicating countries with low HDI values. Countries with data unavailable are coloured grey.       

\
```{r plot1, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(tidyverse)
library(readxl)
library(readr)
library(dplyr)

df<-read_excel('C:/Users/91783/Downloads/HDI_Dataset.xlsx')
df1=df
cd<-read_csv('C:/Users/91783/Downloads/Continents.csv')

mapdata <- map_data("world")

df1$Country[df1$Country =='Hong Kong, China (SAR)']<-'Hong Kong'
df1$Country[df1$Country =='United Kingdom']<-'UK'
df1$Country[df1$Country =='Korea (Republic of)']<-'South Korea'
df1$Country[df1$Country =='United States']<-'USA'
df1$Country[df1$Country =='Czechia']<-'Czech Republic'
df1$Country[df1$Country =='Türkiye']<-'Turkey'
df1$Country[df1$Country =='Brunei Darussalam']<-'Brunei'
df1$Country[df1$Country =='Russian Federation']<-'Russia'
df1$Country[df1$Country =='Trinidad and Tobago']<-'Trinidad'
df1$Country[df1$Country =='Antigua and Barbuda']<-'Antigua'
df1$Country[df1$Country =='Saint Kitts and Nevis']<-'Saint Kitts'
df1$Country[df1$Country =='Iran (Islamic Republic of)']<-'Iran'
df1$Country[df1$Country =='Moldova (Republic of)']<-'Moldova'
df1$Country[df1$Country =='Saint Vincent and the Grenadines']<-'Saint Vincent'
df1$Country[df1$Country =='Palestine, State of']<-'Palestine'
df1$Country[df1$Country =='Viet Nam']<-'Vietnam'
df1$Country[df1$Country =='Bolivia (Plurinational State of)']<-'Bolivia'
df1$Country[df1$Country =='Venezuela (Bolivarian Republic of)']<-'Venezuela'
df1$Country[df1$Country =='Cabo Verde']<-'Cape Verde'
df1$Country[df1$Country =='Micronesia (Federated States of)']<-'Micronesia'
df1$Country[df1$Country =="Lao People's Democratic Republic"]<-'Laos'
df1$Country[df1$Country =='Eswatini (Kingdom of)']<-'Swaziland'
df1$Country[df1$Country =='Syrian Arab Republic']<-'Syria'
df1$Country[df1$Country =='Congo']<-'Republic of Congo'
df1$Country[df1$Country =="Côte d'Ivoire"]<-'Ivory Coast'
df1$Country[df1$Country =='Tanzania (United Republic of)']<-'Tanzania'
df1$Country[df1$Country =='Congo (Democratic Republic of the)']<-'Democratic Republic of the Congo'
df1$Country[df1$Country =="Korea (Democratic People's Rep. of)"]<-'North Korea'

df1 <- rename(df1,
             region="Country")

mapdata <- left_join(mapdata, df1, by="region")

mapdata <- mapdata %>% filter(!is.na(mapdata$region))

map1 <- ggplot(mapdata, aes(x = long, y = lat, group = group)) +
  labs(title="Distribution of HDI by Country in 2021")+
  geom_polygon(aes(fill = HDI_2021)) +
  theme(legend.position = "bottom")

map2 <- map1 + scale_fill_gradient(name="HDI_2021", low="red", high="green", na.value = "grey") +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks = element_blank(),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        rect = element_blank()) +
  ggtitle("HDI for Various Countries on the World Map") +
  theme(plot.title = element_text(hjust = 0.5))  # Center align the title
map2

```

Countries with green shades on the map are considered to have a higher overall development status. These nations typically offer longer life expectancy, better access to education, and higher income levels for their populations. Conversely, countries shaded in red on the map exhibit lower levels of human development. This may be due to factors such as limited access to quality healthcare, education, and economic opportunities.

We can observe how HDI values tend to cluster regionally. Neighboring countries often share similar colors, indicating similarities in development profiles within specific geographic areas.

This heatmap reveals the global landscape of human development, showcasing disparities and trends in well-being across countries.

\
[Growth Across the World, 2015-2021]{.underline}

This map offers a visualization of the Average Annual Human Development Index (HDI) Growth % for countries spanning the period from 2010 to 2021.

```{r plot2, echo=FALSE, warning=FALSE, message=FALSE}
map3 <- ggplot(mapdata, aes(x=long, y = lat,group=group))+
  geom_polygon(aes(fill=G_1021))+
  theme(legend.position = "bottom")

map4 <- map3 + scale_fill_gradient(name="Growth 10 to 21",low="red",high="green",na.value = "grey")+
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks = element_blank(),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        rect=element_blank())+
  ggtitle("Average Annual HDI Growth % on the World Map") +
  theme(plot.title = element_text(hjust = 0.5))

map4
```


Patterns Observed:

- **High HDI, Slower Growth:** Countries characterized by robust HDI values in 2021, exhibit the trend that their HDI growth rates during the 2010-2021 period have been notably moderate. These nations have already reached relatively high levels of development, and as a result, are experiencing slower progress in further enhancing their human development indicators.

- **Low HDI, Rapid Growth:** In stark contrast, nations shown in red on the map, indicating lower HDI levels in 2021, have demonstrated remarkably rapid growth in the preceding decade. Their significant HDI growth underscores efforts in areas such as education, healthcare, and economic opportunities.

Thus, it is observed that underdeveloped economies tend to grow more rapidly than wealthier economies.

\
[Correlation between Factors Contributing to HDI]{.underline}

Since HDI is calculated as the geometric mean of indices on education, life expectancy and income, it is anticipated that these variables will exhibit a strong positive correlation with HDI. Higher values in these variables contribute to higher HDI scores.

```{r plot4, echo=FALSE, warning=FALSE, message=FALSE}
library(corrplot)

# Create a subset of your dataframe
cordf <- subset(df, select=c("HDI_2021", "Life_Ex", "Expected_S", "Mean_S", "GNI_pc"))

# Calculate the correlation matrix
df.cor <- cor(cordf, use = "complete.obs")

# Create a corrplot with upper right triangular layout
corrplot(df.cor, method = "square", order = "hclust", type = "upper", tl.col = "black")

```
\

As per the graph, a strong positive correlation observed among the variables themselves, beyond their relationship with HDI. This interconnectedness reveals that there is a relationship between these human development indicators. For example, Life Expectancy (Life_Ex) and Mean Years of Schooling (Mean_S) display a substantial positive correlation, implying that nations with longer life expectancy tend to have higher levels of mean years of schooling.

The implication is that among the variables national income, education and life expectancy, if a country performs well (or, poorly) in one factor, it is likely to perform well (or, poorly) in the other two factors as well.

```{r plot3, echo=FALSE, warning=FALSE, message=FALSE}
library(corrplot)
library(knitr)
library(kableExtra)

cordf <- subset(df, select=c("HDI_2021","Life_Ex", "Expected_S","Mean_S","GNI_pc"))
df.cor = cor(cordf,  use = "complete.obs")

kable(df.cor, format = "markdown", col.names = colnames(df.cor), 
      caption = "Correlation Matrix") %>%
  kable_styling(font_size = 10)
```

\
[Gross National Income v/s Education and Life Expectancy]{.underline}
\

A striking observation is the non-linear nature of the relationships depicted in the scatter plot. We observe that improvements in education and life expectancy indicators tend to saturate at higher GNI levels.
\
\
\

```{r plot7, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(patchwork)

# Create the first scatter plot
plot1 <- ggplot(df, aes(x = GNI_pc, y = Expected_S, color = HDIL)) +
  geom_point() +
  scale_color_manual(
    values = c("Very High" = "darkgreen", "High" = "green", "Medium" = "yellow", "Low" = "orange", "Other" = "red"),
    breaks = c("Very High", "High", "Medium", "Low", "Other")
  ) +
  labs(
    x = "GNI per Capita",
    y = "Expected Years of Schooling",
    title = "Scatter Plot of GNI per Capita vs. Expected Schooling",
    color = "HDI Level"
  ) +
  theme_minimal()

# Create the second scatter plot
plot2 <- ggplot(df, aes(x = GNI_pc, y = Life_Ex, color = HDIL)) +
  geom_point() +
  scale_color_manual(
    values = c("Very High" = "darkgreen", "High" = "green", "Medium" = "yellow", "Low" = "orange", "Other" = "red"),
    breaks = c("Very High", "High", "Medium", "Low", "Other")
  ) +
  labs(
    x = "GNI per Capita",
    y = "Life Expectancy",
    title = "Scatter Plot of GNI per Capita vs. Life Expectancy",
    color = "HDI Level"
  ) +
  theme_minimal()

# Combine the plots with a common legend at the bottom
combined_plot <- (plot1 / plot2) + plot_layout(guides = "collect")

# Display the combined plot
combined_plot
```
\
\

- **Diminishing Returns:** As GNI increases, the rate of improvement in education and life expectancy tends to slow down. While higher income contributes positively to these indicators, it does not guarantee indefinite increases. After a point, additional income may not lead to significant gains in education or life expectancy.

- **Distribution by HDI Levels:** Very High and High HDI countries tend to possess high GNI, education levels and life expectancy. Low HDI countries are situated at the bottom of the graph. Though some medium-income nations have managed to achieve progress in education and health, others face significant challenges.

\
\
\
\
\
[Distribution of HDI Levels by Continent]{.underline}
\

```{r plot6, echo=FALSE, warning=FALSE, message=FALSE}
cd<-read_csv('C:/Users/91783/Downloads/Continents.csv')

cd$Country[cd$Country =='Burkina'] <-'Burkina Faso'
cd$Country[cd$Country =='Cape Verde'] <-'Cabo Verde'
cd$Country[cd$Country =='Congo, Democratic Republic of'] <-'Congo (Democratic Republic of the)'
cd$Country[cd$Country =='Ivory Coast'] <-"Côte d'Ivoire"
cd$Country[cd$Country =='Swaziland'] <-'Eswatini (Kingdom of)'
cd$Country[cd$Country =='Tanzania'] <-'Tanzania (United Republic of)'
cd$Country[cd$Country =='Brunei'] <-'Brunei Darussalam'
cd$Country[cd$Country =='Burma (Myanmar)'] <-'Myanmar'
cd$Country[cd$Country =='East Timor'] <-'Timor-Leste'
cd$Country[cd$Country =='Iran'] <-'Iran (Islamic Republic of)'
cd$Country[cd$Country =='Korea, North'] <-"Korea (Democratic People's Rep. of)"
cd$Country[cd$Country =='Korea, South'] <-'Korea (Republic of)'
cd$Country[cd$Country =='Laos'] <-"Lao People's Democratic Republic"
cd$Country[cd$Country =='Syria'] <-'Syrian Arab Republic'
cd$Country[cd$Country =='Turkey'] <-'Türkiye'
cd$Country[cd$Country =='Vietnam'] <-'Viet Nam'
cd$Country[cd$Country =='CZ'] <-'Czechia'
cd$Country[cd$Country =='Macedonia'] <-'North Macedonia'
cd$Country[cd$Country =='Moldova'] <-'Moldova (Republic of)'
cd$Country[cd$Country =='Vatican City'] <-''
cd$Country[cd$Country =='US'] <-'United States'
cd$Country[cd$Country =='Micronesia'] <-'Micronesia (Federated States of)'
cd$Country[cd$Country =='Bolivia'] <-'Bolivia (Plurinational State of)'
cd$Country[cd$Country =='Venezuela'] <-'Venezuela (Bolivarian Republic of)'

cd <- left_join(cd, df, by="Country")

library(ggplot2)


# Filter out rows with NA values in HDIL
cd <- cd[!is.na(cd$HDIL), ]

# Define the custom order for the legend
custom_legend_order <- c("Very High", "High", "Medium", "Low", "Other")

# Create a stacked bar chart with a custom legend order
ggplot(cd, aes(x = Continent, fill = factor(HDIL, levels = custom_legend_order))) +
  geom_bar() +
  labs(
    x = "Continent",
    y = "Frequency",
    title = "Stacked Bar Chart of Continent by HDI Levels",
    fill = "HDIL"
  ) +
  theme_minimal() +
  scale_fill_manual(
    values = c(
      "Very High" = "seagreen",
      "High" = "olivedrab3",
      "Medium" = "gold2",
      "Low" = "red4",
      "Other" = "gray40"
    )
  )

```

The following is observed from the stacked bar chart:

- **Africa:** 

    - *Most Number of Countries:* Africa is the continent with the highest number of countries, encompassing a diverse range of HDI levels.
    - *Predominance of Low HDI:* A significant portion of African countries falls into the Low HDI category, highlighting the region's developmental challenges. Africa has the largest concentration of low HDI countries globally.
    - *Medium and High HDI Representation:* While Low HDI countries dominate, Africa also includes countries in the Medium and High HDI categories, though in smaller numbers.

- **Asia:** 

    - *Few Low HDI Countries:* Asia has a smaller proportion of Low HDI countries compared to Africa.
    - *Distributiom of Very High, High and Medium HDIs:* Asia has a balanced distribution of Very High, High and Medium HDIs. We observe that the continent is not overwhelmingly dominated by any one level of HDI.


- **Europe:** 
    
    - *High Proportion of Very High HDI:* A large number of European countries have Very High HDIs, emphasizing the region's advanced development status.
    - *Absence of Low HDI:* Europe does not have any Low HDI countries, signaling a notably higher overall development level.
    

- **North America, South America and Oceania:** 

    - *High and Medium HDI Representation:* These continents predominantly consist of countries in the High and Medium HDI categories, highlighting their advanced development levels.
    - *Limited Low HDI Presence:* The presence of Low HDI countries is limited in North America, and no Low HDI country is present in South America and Oceania.
\

[Mean HDI Values of the Continents for Different Years]{.underline}

The line graph presented below provides a view of how HDI values have evolved across the world's continents over the years.
\

```{r plot5, echo=FALSE, warning=FALSE, message=FALSE}
cd<-read_csv('C:/Users/91783/Downloads/Continents.csv')

cd$Country[cd$Country =='Burkina'] <-'Burkina Faso'
cd$Country[cd$Country =='Cape Verde'] <-'Cabo Verde'
cd$Country[cd$Country =='Congo, Democratic Republic of'] <-'Congo (Democratic Republic of the)'
cd$Country[cd$Country =='Ivory Coast'] <-"Côte d'Ivoire"
cd$Country[cd$Country =='Swaziland'] <-'Eswatini (Kingdom of)'
cd$Country[cd$Country =='Tanzania'] <-'Tanzania (United Republic of)'
cd$Country[cd$Country =='Brunei'] <-'Brunei Darussalam'
cd$Country[cd$Country =='Burma (Myanmar)'] <-'Myanmar'
cd$Country[cd$Country =='East Timor'] <-'Timor-Leste'
cd$Country[cd$Country =='Iran'] <-'Iran (Islamic Republic of)'
cd$Country[cd$Country =='Korea, North'] <-"Korea (Democratic People's Rep. of)"
cd$Country[cd$Country =='Korea, South'] <-'Korea (Republic of)'
cd$Country[cd$Country =='Laos'] <-"Lao People's Democratic Republic"
cd$Country[cd$Country =='Syria'] <-'Syrian Arab Republic'
cd$Country[cd$Country =='Turkey'] <-'Türkiye'
cd$Country[cd$Country =='Vietnam'] <-'Viet Nam'
cd$Country[cd$Country =='CZ'] <-'Czechia'
cd$Country[cd$Country =='Macedonia'] <-'North Macedonia'
cd$Country[cd$Country =='Moldova'] <-'Moldova (Republic of)'
cd$Country[cd$Country =='Vatican City'] <-''
cd$Country[cd$Country =='US'] <-'United States'
cd$Country[cd$Country =='Micronesia'] <-'Micronesia (Federated States of)'
cd$Country[cd$Country =='Bolivia'] <-'Bolivia (Plurinational State of)'
cd$Country[cd$Country =='Venezuela'] <-'Venezuela (Bolivarian Republic of)'

cd <- left_join(cd, df, by="Country")

# Load required libraries
library(ggplot2)
library(dplyr)

# Calculate mean HDI values grouped by Continent
mean_hdi_by_continent <- cd %>%
  select(Continent, HDI_1990:HDI_2021) %>%
  pivot_longer(cols = starts_with("HDI_"), names_to = "Year", values_to = "HDI") %>%
  group_by(Continent, Year) %>%
  summarize(mean_HDI = mean(HDI, na.rm = TRUE))

# Create a line plot

mean_hdi_by_continent <- mean_hdi_by_continent %>%
  mutate(Year = as.numeric(gsub("HDI_", "", Year)))

# Create a line plot with numeric x-axis
ggplot(mean_hdi_by_continent, aes(x = Year, y = mean_HDI, color = Continent, group = Continent)) +
  geom_line(size = 1.5) +
  labs(
    x = "Year",
    y = "Mean HDI Value",
    title = "Mean HDI Values by Continent Over Time",
    color = "Continent"
  ) +
  theme_minimal()

```

From the graph, we observe the following key takeaways:

- **Global Progress:** Over the years, the global HDI landscape has generally improved, reflecting advancements in education, healthcare, and economic well-being worldwide.

- **Continental Diversity:** The graph highlights the diverse HDI trajectories followed by different continents. We observe consistently since 1990, that Europe and Africa have been the continents with the maximum and minimum mean HDI values respectively. 
\
\
\
\

[Top 5 Maximum and Bottom 5 Minimum Changes in HDI Ranks (2015 to 2021)]{.underline}

Human Development Index ranks serve as a measure of a nation's progress in improving the well-being of its citizens, relative to other nations. The following graph describes the changes in HDI ranks from 2015 to 2021, offering insights into countries that have witnessed significant advancements and those which face challenges in their journey toward human development.

```{r plot8, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

# Convert 'Ch_1521' column to numeric
df$Ch_1521 <- as.numeric(df$Ch_1521)

# Sort the DataFrame by 'Ch_1521' column in descending order and select the top 5 and bottom 5 rows
top_df <- head(df[order(-df$Ch_1521), ], 5)
bottom_df <- head(df[order(df$Ch_1521), ], 5)

# Combine the top and bottom DataFrames
combined_df <- rbind(top_df, bottom_df)

# Create a horizontal bar plot
ggplot(combined_df, aes(x = reorder(Country, Ch_1521), y = Ch_1521, fill = Ch_1521 > 0)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  labs(x = "Country", y = "Change in Rank", fill = "Positive Change") +
  scale_fill_manual(values = c("TRUE" = "blue", "FALSE" = "red")) +
  theme_minimal() +
  theme(legend.position = "none") +  # Remove the legend
  ggtitle("Changes in HDI Ranks from 2015 to 2021")
```

It can be observed from the graph that **China** has demonstrated the greatest positive change in HDI Rank, ascending significantly during this period. **Venezuela** on the other hand, fell more than 40 ranks, implying that the country faced severe challenges during this period.

# Results

- HDI values tend to cluster regionally, i.e., neighboring countries often share similar HDI values.

- High HDI countries show moderate growth, whereas Low HDI countries experience rapid progress. This implies that underdeveloped economies tend to grow more rapidly than wealthier economies.

- There exists strong positive correlations among education, life expectancy, income, and HDI. Nations excelling in one factor tend to excel in others.

- On comparing Gross National Income with Education and Life Expectancy, we observe that improvements tend to saturate at higher GNI levels. This implies that returns diminish with higher income.

- Africa has the most countries in the world, and the maximum proportion of Low HDI countries. Europe is dominated by Very High HDI countries while Asia has a balanced distribution.

- It is observed with consistency that Europe and Africa have been the continents with the maximum and minimum mean HDI values respectively.

- With respect to change in HDI Ranks from 2015 to 2021, China has had a significant positive change while Venezuela has suffered a substantial drop in ranks.

# Conclusion

The implications of these results offer insights into global development challenges and opportunities. It portrays a need for tailored development strategies in areas with lower human development. We also observe that for development of a region, simply increasing income may not guarantee improved quality of life. Instead, targeted interventions are required.

The multidimensional nature of human development reveals disparities, growth patterns, and interconnectedness among factors. The implications extend to policy formulation in order to improve the well-being of populations worldwide.